"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[9480],{35318:function(e,n,t){t.d(n,{Zo:function(){return l},kt:function(){return f}});var a=t(27378);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function c(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var s=a.createContext({}),p=function(e){var n=a.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},l=function(e){var n=p(e.components);return a.createElement(s.Provider,{value:n},e.children)},d={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},u=a.forwardRef((function(e,n){var t=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,l=c(e,["components","mdxType","originalType","parentName"]),u=p(t),f=r,m=u["".concat(s,".").concat(f)]||u[f]||d[f]||i;return t?a.createElement(m,o(o({ref:n},l),{},{components:t})):a.createElement(m,o({ref:n},l))}));function f(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var i=t.length,o=new Array(i);o[0]=u;var c={};for(var s in n)hasOwnProperty.call(n,s)&&(c[s]=n[s]);c.originalType=e,c.mdxType="string"==typeof e?e:r,o[1]=c;for(var p=2;p<i;p++)o[p]=t[p];return a.createElement.apply(null,o)}return a.createElement.apply(null,t)}u.displayName="MDXCreateElement"},17701:function(e,n,t){t.r(n),t.d(n,{contentTitle:function(){return s},default:function(){return u},frontMatter:function(){return c},metadata:function(){return p},toc:function(){return l}});var a=t(25773),r=t(30808),i=(t(27378),t(35318)),o=["components"],c={},s="Getting and Updating Preferences",p={unversionedId:"learn-by-examples/notification-preference-center/getting-and-updating-preferences",id:"learn-by-examples/notification-preference-center/getting-and-updating-preferences",title:"Getting and Updating Preferences",description:"You can update your user's notification preference in your app using Engagespot REST API or through any of our client SDKs.",source:"@site/docs/learn-by-examples/notification-preference-center/getting-and-updating-preferences.md",sourceDirName:"learn-by-examples/notification-preference-center",slug:"/learn-by-examples/notification-preference-center/getting-and-updating-preferences",permalink:"/docs/learn-by-examples/notification-preference-center/getting-and-updating-preferences",editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/learn-by-examples/notification-preference-center/getting-and-updating-preferences.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Basics of Preference Center",permalink:"/docs/learn-by-examples/notification-preference-center/concepts"},next:{title:"Error Codes",permalink:"/docs/troubleshooting/error-codes"}},l=[{value:"Using REST API",id:"using-rest-api",children:[{value:"Reading Existing Preferences",id:"reading-existing-preferences",children:[],level:3},{value:"Updating Preference",id:"updating-preference",children:[],level:3}],level:2}],d={toc:l};function u(e){var n=e.components,t=(0,r.Z)(e,o);return(0,i.kt)("wrapper",(0,a.Z)({},d,t,{components:n,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"getting-and-updating-preferences"},"Getting and Updating Preferences"),(0,i.kt)("p",null,"You can update your user's notification preference in your app using ",(0,i.kt)("a",{parentName:"p",href:"/docs/rest-api"},"Engagespot REST API")," or through any of our client SDKs."),(0,i.kt)("h2",{id:"using-rest-api"},"Using REST API"),(0,i.kt)("p",null,"You should use the ",(0,i.kt)("inlineCode",{parentName:"p"},"preferences")," ",(0,i.kt)("a",{parentName:"p",href:"/docs/rest-api#tag/Preferences/paths/~1v3~1preferences/get"},"endpoint")," to read and set preferences of a user."),(0,i.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"When you make this API call, you're authenticating yourself as the User of your app. And this is achieved using the X-ENGAGESPOT-USER-ID header. (Also, make sure to pass ",(0,i.kt)("strong",{parentName:"p"},"X-ENGAGESPOT-API-SECRET")," if your app has ",(0,i.kt)("a",{parentName:"p",href:"/docs/HMAC-authentication/enabling-HMAC-authentication"},"HMAC Authentication")," turned ON.)"))),(0,i.kt)("h3",{id:"reading-existing-preferences"},"Reading Existing Preferences"),(0,i.kt)("p",null,"To read the existing preferences, send a ",(0,i.kt)("strong",{parentName:"p"},"GET")," request to ",(0,i.kt)("inlineCode",{parentName:"p"},"/preferences")," ",(0,i.kt)("a",{parentName:"p",href:"/docs/rest-api#tag/Preferences/paths/~1v3~1preferences/get"},"endpoint"),". This will return an array of preference objects. Each preference object has a ",(0,i.kt)("inlineCode",{parentName:"p"},"categoryId"),", and a ",(0,i.kt)("inlineCode",{parentName:"p"},"channelPreferences")," array which contains the status of channel in that category."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'[\n  {\n    "category": {\n      "id": 1,\n      "name": "Comment",\n      "identifier": "comment"\n    },\n    "channelPreferences": [\n      {\n        "channel": "inApp",\n        "enabled": 1\n      },\n      {\n        "channel": "email",\n        "enabled": 1\n      }\n    ]\n  }\n]\n')),(0,i.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"If a user has not explicitly defined a preference rule for a channel on a category, that rule won't be listed in the above response. Also, that means that notifications are enabled by default for that channel."))),(0,i.kt)("p",null,"Since this API won't return the categories for which the user has not set any preferences yet, you might need to use the ",(0,i.kt)("a",{parentName:"p",href:"/docs/rest-api#tag/Preferences/paths/~1v3~1categories/get"},"Categories")," API to get a list of all categories in the app."),(0,i.kt)("h3",{id:"updating-preference"},"Updating Preference"),(0,i.kt)("p",null,'Let\'s say a user wants to disable "Comment" notifications via email, but enable Mobile App Push notifications for the same. We can update this preference in a single API call.'),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"PATCH")," ",(0,i.kt)("inlineCode",{parentName:"p"},"/preferences")," ",(0,i.kt)("a",{parentName:"p",href:"/docs/rest-api#tag/Preferences/paths/~1v3~1preferences/patch"},"View API Doc")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "preference": [\n    {\n      "categoryId": 1,\n      "channels": [\n        {\n          "channel": "email",\n          "enabled": false\n        },\n        {\n          "channel": "mobilePush",\n          "enabled": true\n        }\n      ]\n    }\n  ]\n}\n')),(0,i.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"The list of channels and their identifiers are given in the ",(0,i.kt)("a",{parentName:"p",href:"/docs/channels/what-are-channels"},"Channels")," chapter."))))}u.isMDXComponent=!0}}]);