"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[9480],{3133:function(e,n,t){t.r(n),t.d(n,{assets:function(){return p},contentTitle:function(){return o},default:function(){return u},frontMatter:function(){return i},metadata:function(){return c},toc:function(){return s}});var r=t(52685),a=(t(27378),t(35318));const i={},o="Getting and Updating Preferences",c={unversionedId:"learn-by-examples/notification-preference-center/getting-and-updating-preferences",id:"learn-by-examples/notification-preference-center/getting-and-updating-preferences",title:"Getting and Updating Preferences",description:"You can update your user's notification preference in your app using Engagespot REST API or through any of our client SDKs.",source:"@site/docs/learn-by-examples/notification-preference-center/getting-and-updating-preferences.md",sourceDirName:"learn-by-examples/notification-preference-center",slug:"/learn-by-examples/notification-preference-center/getting-and-updating-preferences",permalink:"/docs/learn-by-examples/notification-preference-center/getting-and-updating-preferences",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/learn-by-examples/notification-preference-center/getting-and-updating-preferences.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Basics of Preference Center",permalink:"/docs/learn-by-examples/notification-preference-center/concepts"},next:{title:"index",permalink:"/docs/api-reference/react-component/"}},p={},s=[{value:"Using REST API",id:"using-rest-api",level:2},{value:"Reading Existing Preferences",id:"reading-existing-preferences",level:3},{value:"Updating Preference",id:"updating-preference",level:3}],l={toc:s};function u(e){let{components:n,...t}=e;return(0,a.kt)("wrapper",(0,r.Z)({},l,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"getting-and-updating-preferences"},"Getting and Updating Preferences"),(0,a.kt)("p",null,"You can update your user's notification preference in your app using ",(0,a.kt)("a",{parentName:"p",href:"/docs/rest-api"},"Engagespot REST API")," or through any of our client SDKs."),(0,a.kt)("h2",{id:"using-rest-api"},"Using REST API"),(0,a.kt)("p",null,"You should use the ",(0,a.kt)("inlineCode",{parentName:"p"},"preferences")," ",(0,a.kt)("a",{parentName:"p",href:"/docs/rest-api#tag/Preferences/paths/~1v3~1preferences/get"},"endpoint")," to read and set preferences of a user."),(0,a.kt)("admonition",{type:"tip"},(0,a.kt)("p",{parentName:"admonition"},"When you make this API call, you're authenticating yourself as the User of your app. And this is achieved using the X-ENGAGESPOT-USER-ID header. (Also, make sure to pass ",(0,a.kt)("strong",{parentName:"p"},"X-ENGAGESPOT-API-SECRET")," if your app has ",(0,a.kt)("a",{parentName:"p",href:"/docs/user/enabling-HMAC-authentication"},"HMAC Authentication")," turned ON.)")),(0,a.kt)("h3",{id:"reading-existing-preferences"},"Reading Existing Preferences"),(0,a.kt)("p",null,"To read the existing preferences, send a ",(0,a.kt)("strong",{parentName:"p"},"GET")," request to ",(0,a.kt)("inlineCode",{parentName:"p"},"/preferences")," ",(0,a.kt)("a",{parentName:"p",href:"/docs/rest-api#tag/Preferences/paths/~1v3~1preferences/get"},"endpoint"),". This will return an array of preference objects. Each preference object has a ",(0,a.kt)("inlineCode",{parentName:"p"},"categoryId"),", and a ",(0,a.kt)("inlineCode",{parentName:"p"},"channelPreferences")," array which contains the status of channel in that category."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-json"},'[\n  {\n    "category": {\n      "id": 1,\n      "name": "Comment",\n      "identifier": "comment"\n    },\n    "channelPreferences": [\n      {\n        "channel": "inApp",\n        "enabled": 1\n      },\n      {\n        "channel": "email",\n        "enabled": 1\n      }\n    ]\n  }\n]\n')),(0,a.kt)("admonition",{type:"info"},(0,a.kt)("p",{parentName:"admonition"},"If a user has not explicitly defined a preference rule for a channel on a category, that rule won't be listed in the above response. Also, that means that notifications are enabled by default for that channel.")),(0,a.kt)("p",null,"Since this API won't return the categories for which the user has not set any preferences yet, you might need to use the ",(0,a.kt)("a",{parentName:"p",href:"/docs/rest-api#tag/Preferences/paths/~1v3~1categories/get"},"Categories")," API to get a list of all categories in the app."),(0,a.kt)("h3",{id:"updating-preference"},"Updating Preference"),(0,a.kt)("p",null,'Let\'s say a user wants to disable "Comment" notifications via email, but enable Mobile App Push notifications for the same. We can update this preference in a single API call.'),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"PATCH")," ",(0,a.kt)("inlineCode",{parentName:"p"},"/preferences")," ",(0,a.kt)("a",{parentName:"p",href:"/docs/rest-api#tag/Preferences/paths/~1v3~1preferences/patch"},"View API Doc")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "preference": [\n    {\n      "categoryId": 1,\n      "channels": [\n        {\n          "channel": "email",\n          "enabled": false\n        },\n        {\n          "channel": "mobilePush",\n          "enabled": true\n        }\n      ]\n    }\n  ]\n}\n')),(0,a.kt)("admonition",{type:"tip"},(0,a.kt)("p",{parentName:"admonition"},"The list of channels and their identifiers are given in the ",(0,a.kt)("a",{parentName:"p",href:"/docs/channels/what-are-channels"},"Channels")," chapter.")))}u.isMDXComponent=!0},35318:function(e,n,t){t.d(n,{Zo:function(){return l},kt:function(){return d}});var r=t(27378);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function c(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var p=r.createContext({}),s=function(e){var n=r.useContext(p),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},l=function(e){var n=s(e.components);return r.createElement(p.Provider,{value:n},e.children)},u={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},f=r.forwardRef((function(e,n){var t=e.components,a=e.mdxType,i=e.originalType,p=e.parentName,l=c(e,["components","mdxType","originalType","parentName"]),f=s(t),d=a,g=f["".concat(p,".").concat(d)]||f[d]||u[d]||i;return t?r.createElement(g,o(o({ref:n},l),{},{components:t})):r.createElement(g,o({ref:n},l))}));function d(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var i=t.length,o=new Array(i);o[0]=f;var c={};for(var p in n)hasOwnProperty.call(n,p)&&(c[p]=n[p]);c.originalType=e,c.mdxType="string"==typeof e?e:a,o[1]=c;for(var s=2;s<i;s++)o[s]=t[s];return r.createElement.apply(null,o)}return r.createElement.apply(null,t)}f.displayName="MDXCreateElement"}}]);